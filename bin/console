#!/usr/bin/env python

import os
import optparse
from subprocess import call

def main():
	p = optparse.OptionParser()
	p.add_option('--run', '-r', default="false")
	options, arguments = p.parse_args()
        if ('run' in arguments):
            run()
        else:
            p.print_help()

def run():
    try:

        bin_path = os.path.dirname(os.path.abspath(__file__))   
        src_path = os.path.normpath(os.path.join(bin_path, '../'))
        start_script = os.path.join(src_path, 'index.lua')
        meter_cmd = os.path.join(bin_path, 'meter') 
        meter_params = '--lua ' + start_script
        meter_cmdline = meter_cmd + ' ' + meter_params
        print(meter_cmdline)
        call([meter_cmd, '--lua', start_script]) 
    
    except KeyboardInterrupt:
        pass # Silently exit


if __name__ == '__main__':
	main()
